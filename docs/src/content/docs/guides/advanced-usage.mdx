---
title: "高度な使い方"
description: "esa-cliの高度なコマンド使用例と実践的なシナリオ"
---

import { Tabs, TabItem } from '@astrojs/starlight/components';

ドキュメント管理やナレッジ共有をさらに効率化するために、カテゴリ・タグの活用や一括処理など、実務で役立つ高度な操作例を紹介します。

## カテゴリ・タグで絞り込み

<Tabs>
  <TabItem label="カテゴリで絞り込み">
    ```bash
    esa-cli list -category "開発/設計"
    ```
  </TabItem>

  <TabItem label="タグで絞り込み">
    ```bash
    esa-cli list -tag "API"
    ```
  </TabItem>
</Tabs>

## 一括ダウンロード＆一括更新

カテゴリやタグで絞り込んで記事を一括ダウンロードしたり、一括更新したりできます。  
「カテゴリやタグで絞り込んだ記事の大規模なリネーム」「一括でタグや本文を修正したい」など、さまざまな場面で活用できます。


### 記事を一括ダウンロード

カレントディレクトリに `記事番号-タイトル.md` 形式のMarkdownファイルが一括保存されます。

<Tabs>
  <TabItem label="カテゴリで指定">
    ```bash
    esa-cli list -category "開発/設計" | cut -d':' -f1 | while read -r article_id; do
      esa-cli fetch "$article_id"
    done
    ```
  </TabItem>
  <TabItem label="タグで指定">
    ```bash
    esa-cli list -tag "重要" | cut -d':' -f1 | while read -r article_id; do
      esa-cli fetch "$article_id"
    done
    ```
  </TabItem>
  <TabItem label="最新記事をダウンロード">
    ```bash
    # 特定のカテゴリの最新記事をダウンロード
    esa-cli fetch -category "開発/設計" -latest
    
    # 特定のタグの最新記事をダウンロード
    esa-cli fetch -tag "重要" -latest
    ```
  </TabItem>
  <TabItem label="より安全な方法">
    ```bash
    esa-cli list -category "開発/設計" | while read -r line; do
      article_id=$(echo "$line" | cut -d':' -f1 | tr -d ' ')
      if [[ "$article_id" =~ ^[0-9]+$ ]]; then
        esa-cli fetch "$article_id"
      fi
    done
    ```
  </TabItem>
</Tabs>

### 一括で再アップロード（更新）

ファイル名が `記事番号-タイトル.md` 形式であれば、そのまま一括で更新できます。

```bash
for file in *.md; do
  esa-cli update "$file"
done
```

## バックアップ・リストア

**毎日のバックアップスクリプト例**
```bash
#!/bin/bash
DATE=$(date +%Y%m%d)
BACKUP_DIR="./backup/$DATE"
mkdir -p "$BACKUP_DIR"

# 全記事をバックアップ
esa-cli list | cut -d':' -f1 | while read -r article_id; do
  esa-cli fetch "$article_id"
done

# ダウンロードしたファイルをバックアップディレクトリに移動
mv *-*.md "$BACKUP_DIR"
```

## 複数条件での絞り込み

カテゴリ、タグ、作成者、検索ワードを組み合わせて記事を絞り込めます。

```bash
# カテゴリとタグの組み合わせ
esa-cli list -c 開発 -t API
esa-cli list --category 開発 --tag API

# 作成者とカテゴリの組み合わせ
esa-cli list -c 開発 -u 自分のユーザー名
esa-cli list --category 開発 --user 自分のユーザー名

# 検索ワードとタグの組み合わせ
esa-cli list -q 認証 -t API
esa-cli list --query 認証 --tag API
```

## 効率的な記事管理

### 最新記事の自動ダウンロード

特定の条件で最新記事を自動的にダウンロードできます。

```bash
# 開発カテゴリの最新記事をダウンロード
esa-cli fetch -c 開発 -l
esa-cli fetch --category 開発 --latest

# 自分が作成したAPI関連の最新記事をダウンロード
esa-cli fetch -t API -u 自分のユーザー名 -l
esa-cli fetch --tag API --user 自分のユーザー名 --latest
```

### 一括更新の効率化

複数の記事を効率的に更新できます。

```bash
# カテゴリを変更して更新
esa-cli update 123-article-title.md -c 開発
esa-cli update 123-article-title.md --category 開発

# タグを追加して更新
esa-cli update 123-article-title.md -a API,認証
esa-cli update 123-article-title.md --add-tags API,認証

# タグを削除して更新
esa-cli update 123-article-title.md -r 古いタグ
esa-cli update 123-article-title.md --remove-tags 古いタグ

# WIP状態を解除して更新
esa-cli update 123-article-title.md -n
esa-cli update 123-article-title.md --no-wip
```

## 記事の一括整理

### カテゴリの一括移動

プロジェクトの進行に合わせて記事を効率的に整理できます。

```bash
# 開発完了した記事をドキュメントカテゴリに移動
esa-cli move -c 開発 -o ドキュメント -u 自分のユーザー名
esa-cli move --category 開発 --to ドキュメント --user 自分のユーザー名

# 複数条件で絞り込んで移動
esa-cli move -c 開発 -t API -u 自分のユーザー名 -o ドキュメント
esa-cli move --category 開発 --tag API --user 自分のユーザー名 --to ドキュメント
```

### 自動化とスクリプト化

確認プロンプトをスキップして自動実行できます。

```bash
# 確認なしで強制実行
esa-cli move -c 開発 -o ドキュメント -u 自分のユーザー名 -f
esa-cli move --category 開発 --to ドキュメント --user 自分のユーザー名 --force

# カスタムメッセージ付きで移動
esa-cli move -c 開発 -o ドキュメント -u 自分のユーザー名 -m リファクタリング完了
esa-cli move --category 開発 --to ドキュメント --user 自分のユーザー名 --message リファクタリング完了
```

### シェルスクリプトでの活用

```bash
#!/bin/bash
# 開発完了した記事を一括移動するスクリプト

echo "開発完了した記事をドキュメントに移動します..."

# 開発カテゴリで自分が作成した記事をドキュメントに移動
esa-cli move -c 開発 -o ドキュメント -u 自分のユーザー名 -f -m "開発完了による移動"

echo "移動が完了しました！"
```

## チーム作業での安全な更新

### リモート変更の検出

チームで記事を編集する際、他の人の変更を誤って上書きすることを防げます。

```bash
# 更新時にリモート変更があれば警告が表示されます
esa-cli update 123-article-title.md
```

**警告例：**
```
⚠️  警告: リモートの記事はローカルで編集を始めてから更新されています。
  リモート: 2025-06-22 14:01:45
  ローカル: 2025-06-21 09:32:41
このまま上書きしますか？ (y/N):
```

### 安全な更新のベストプラクティス

1. **更新前に最新状態を確認**
   ```bash
   esa-cli fetch 123  # 最新状態を取得
   ```

2. **変更履歴を明確に記録**
   ```bash
   esa-cli update 123-article-title.md -m "API仕様を更新"
   esa-cli update 123-article-title.md --message "API仕様を更新"
   ```

3. **WIP状態の適切な管理**
   ```bash
   # 作業中はWIP状態で更新
   esa-cli update 123-article-title.md
   
   # 完了時はWIPを解除
   esa-cli update 123-article-title.md -n
   esa-cli update 123-article-title.md --no-wip
   ```

## カスタマイズ・自動化

- **エディタやFinderとの連携、通知機能の活用**
- **シェルスクリプトでの自動化例**

さらに詳細なコマンド仕様は[コマンドリファレンス](/esa-cli/commands)を参照してください。 