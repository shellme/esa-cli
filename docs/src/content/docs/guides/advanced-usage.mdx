---
title: "高度な使い方"
description: "esa-cliの高度なコマンド使用例と実践的なシナリオ"
---

import { Tabs, TabItem } from '@astrojs/starlight/components';

ドキュメント管理やナレッジ共有をさらに効率化するために、カテゴリ・タグの活用や一括処理など、実務で役立つ高度な操作例を紹介します。

## カテゴリ・タグで絞り込み

<Tabs>
  <TabItem label="カテゴリで絞り込み">
    ```bash
    esa-cli list -category "開発/設計"
    ```
  </TabItem>

  <TabItem label="タグで絞り込み">
    ```bash
    esa-cli list -tag "API"
    ```
  </TabItem>
</Tabs>

## 一括ダウンロード＆一括更新

カテゴリやタグで絞り込んで記事を一括ダウンロードしたり、一括更新したりできます。  
「カテゴリやタグで絞り込んだ記事の大規模なリネーム」「一括でタグや本文を修正したい」など、さまざまな場面で活用できます。


### 記事を一括ダウンロード

カレントディレクトリに `記事番号-タイトル.md` 形式のMarkdownファイルが一括保存されます。

<Tabs>
  <TabItem label="カテゴリで指定">
    ```bash
    esa-cli list -category "開発/設計" | cut -d':' -f1 | while read -r article_id; do
      esa-cli fetch "$article_id"
    done
    ```
  </TabItem>
  <TabItem label="タグで指定">
    ```bash
    esa-cli list -tag "重要" | cut -d':' -f1 | while read -r article_id; do
      esa-cli fetch "$article_id"
    done
    ```
  </TabItem>
  <TabItem label="最新記事をダウンロード">
    ```bash
    # 特定のカテゴリの最新記事をダウンロード
    esa-cli fetch -category "開発/設計" -latest
    
    # 特定のタグの最新記事をダウンロード
    esa-cli fetch -tag "重要" -latest
    ```
  </TabItem>
  <TabItem label="より安全な方法">
    ```bash
    esa-cli list -category "開発/設計" | while read -r line; do
      article_id=$(echo "$line" | cut -d':' -f1 | tr -d ' ')
      if [[ "$article_id" =~ ^[0-9]+$ ]]; then
        esa-cli fetch "$article_id"
      fi
    done
    ```
  </TabItem>
</Tabs>

### 一括で再アップロード（更新）

ファイル名が `記事番号-タイトル.md` 形式であれば、そのまま一括で更新できます。

```bash
for file in *.md; do
  esa-cli update "$file"
done
```

## バックアップ・リストア

**毎日のバックアップスクリプト例**
```bash
#!/bin/bash
DATE=$(date +%Y%m%d)
BACKUP_DIR="./backup/$DATE"
mkdir -p "$BACKUP_DIR"

# 全記事をバックアップ
esa-cli list | cut -d':' -f1 | while read -r article_id; do
  esa-cli fetch "$article_id"
done

# ダウンロードしたファイルをバックアップディレクトリに移動
mv *-*.md "$BACKUP_DIR"
```

## 高度な検索・フィルタリング

**複数条件で検索**
```bash
esa-cli list -query "設計" -category "開発" -tag "API"
```

## チーム作業での安全な更新

複数人で同じ記事を編集する際の競合を防ぐために、リモート変更チェック機能を活用できます。

### 一括更新時の安全対策

```bash
# 一括更新前にリモート変更をチェック
for file in *.md; do
  echo "更新中: $file"
  esa-cli update "$file"
  # リモート変更があれば確認プロンプトが表示されます
done
```

### 自動化スクリプトでの活用

```bash
#!/bin/bash
# 安全な一括更新スクリプト

for file in *.md; do
  if [[ "$file" =~ ^[0-9]+-.*\.md$ ]]; then
    echo "更新中: $file"
    
    # 更新を実行（リモート変更があれば確認プロンプトが表示）
    if esa-cli update "$file"; then
      echo "✅ 更新完了: $file"
    else
      echo "❌ 更新失敗またはキャンセル: $file"
    fi
  fi
done
```

### 競合回避のベストプラクティス

1. **定期的な同期**: 作業開始前に最新の記事を`fetch`で取得
2. **小さな変更**: 大きな変更は複数の小さな更新に分割
3. **コミュニケーション**: チーム内で同時編集を避ける
4. **バックアップ**: 重要な変更前にはローカルバックアップを作成

## カスタマイズ・自動化

- **エディタやFinderとの連携、通知機能の活用**
- **シェルスクリプトでの自動化例**

さらに詳細なコマンド仕様は[コマンドリファレンス](./commands/)を参照してください。 