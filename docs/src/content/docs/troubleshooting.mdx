---
title: "トラブルシューティング"
description: "esa-cliの問題解決ガイド"
---

esa-cliの使用中に発生する可能性のある問題と、その解決方法を詳しく説明します。

## インストールの問題

### Homebrewアップグレードエラー

#### 症状
- `brew upgrade esa-cli` で以下のエラーが発生する：
```
Error: An exception occurred within a child process:
  RuntimeError: Will not overwrite /opt/homebrew/etc/esa-cli/config.template
```

#### 原因
既存の設定ファイル（`config.template`）が存在するため、Homebrewが上書きを拒否している状態です。

#### 解決手順

1. 既存の設定ファイルを削除
```bash
rm /opt/homebrew/etc/esa-cli/config.template
```

2. アップグレードを再実行
```bash
brew upgrade esa-cli
```

#### 予防策
このエラーは以下の場合に発生する可能性があります：
- 初回インストール後のアップグレード時
- 手動で設定ファイルを編集した場合
- Formulaの変更があった場合

通常、一度解決すれば今後のアップグレードでは発生しません。

### インストールが完了しない

#### 症状
- `brew install` コマンドが失敗する
- インストール中にエラーメッセージが表示される

#### 解決手順

1. 既存のインストールを削除
```bash
brew uninstall esa-cli
```

2. 再インストール
```bash
# tapが既に追加されている場合は直接インストール
brew install shellme/esa-cli

# もしくは、tapを明示的に追加してからインストール
brew tap shellme/esa-cli
brew install esa-cli
```

3. インストールの確認
```bash
esa-cli version
```

### コマンドが見つからない

#### 症状
- `esa-cli` コマンドを実行すると「command not found」エラーが表示される

#### 解決手順

1. パスの確認
```bash
echo $PATH
```

2. バイナリの場所を確認
```bash
which esa-cli
```

3. シェルの設定ファイルにパスを追加

bashの場合：
```bash
echo 'export PATH="/usr/local/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc
```

zshの場合：
```bash
echo 'export PATH="/usr/local/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

fishの場合：
```fish
echo 'set -gx PATH /usr/local/bin $PATH' >> ~/.config/fish/config.fish
source ~/.config/fish/config.fish
```

## 認証の問題

### アクセストークンが無効

#### 症状
- コマンド実行時に認証エラーが発生
- `esa-cli setup` で設定したトークンが機能しない

#### 解決手順

1. 現在の設定を確認
```bash
cat ~/.esa-cli-config.json
```

2. 新しいトークンを生成
   - esa.ioのアプリケーション設定ページにアクセス
   - 既存のトークンを削除
   - 新しいトークンを生成

3. 設定を更新
```bash
esa-cli setup
```

## 記事の操作に関する問題

### 記事の更新が反映されない

#### 症状
- `esa-cli update` を実行しても記事が更新されない
- エラーメッセージが表示される

#### 解決手順

1. ファイル名の確認
   - 正しい形式: `記事番号-タイトル.md`
   - 例: `123-my-article.md`

2. Front Matterの確認
```markdown
---
title: 記事のタイトル
category: カテゴリ
tags: [tag1, tag2]
wip: false
---
```

3. ネットワーク接続の確認
```bash
ping esa.io
```

4. 記事の存在確認
```bash
esa-cli list | grep 記事番号
```

### 記事のダウンロードに失敗

#### 症状
- `esa-cli fetch` で記事をダウンロードできない
- ダウンロードしたファイルが破損している

#### 解決手順

1. 記事番号の確認
```bash
esa-cli list
```

2. 一時ファイルの削除
```bash
rm -f *-article-title.md
```

3. 再ダウンロード
```bash
esa-cli fetch 記事番号
```

## その他の問題

### 通知が表示されない

#### 症状
- 記事のダウンロードや更新時に通知が表示されない

#### 解決手順

1. 通知の権限を確認
   - システム環境設定 > 通知
   - ターミナルの通知を許可

2. 通知のテスト
```bash
esa-cli fetch 1
```

## 関連ドキュメント

- [よくある質問](./faq) - 一般的な質問と回答
- [初期設定と基本操作](./getting-started/first-steps) - 基本的な使い方
- [コマンドリファレンス](./commands) - コマンドの詳細な説明

## よくある問題と解決方法

### コマンドが見つからない

**問題**: `esa-cli: command not found` エラーが発生する

**解決方法**:
1. インストールが完了しているか確認
```bash
which esa-cli
```

2. パスが正しく設定されているか確認
```bash
echo $PATH
```

3. 必要に応じてパスを追加
```bash
# bash/zshの場合
export PATH="/usr/local/bin:$PATH"

# fishの場合
set -gx PATH /usr/local/bin $PATH
```

### オプションが認識されない

**問題**: `unknown flag` エラーが発生する

**原因**: 古いオプション形式を使用している

**解決方法**: 新しいオプション形式を使用する

```bash
# 古い形式（非推奨）
esa-cli list -category 開発

# 新しい形式（推奨）
esa-cli list -c 開発
esa-cli list --category 開発
```

**正しいオプション形式**:
- `-c, --category` - カテゴリでフィルタ
- `-t, --tag` - タグでフィルタ
- `-q, --query` - 検索キーワード
- `-u, --user` - 作成者でフィルタ
- `-l, --latest` - 最新記事を取得
- `-m, --message` - メッセージを指定
- `-n, --no-wip` - WIP状態を解除
- `-a, --add-tags` - タグを追加
- `-r, --remove-tags` - タグを削除
- `-o, --to` - 移動先カテゴリ
- `-f, --force` - 確認なしで実行

### 認証エラー

**問題**: `401 Unauthorized` エラーが発生する

**原因**: アクセストークンが無効または期限切れ

**解決方法**:
1. 新しいアクセストークンを生成
2. 設定を再実行
```bash
esa-cli setup
```

### 記事が見つからない

**問題**: `404 Not Found` エラーが発生する

**原因**:
- 記事番号が間違っている
- 記事が削除されている
- 権限がない

**解決方法**:
1. 記事番号を確認
```bash
esa-cli list
```

2. 権限を確認
3. 記事が存在するか確認

### リモート変更チェックの警告

**問題**: 更新時に「リモートの記事は更新されています」と警告が出る

**原因**: 他の人が記事を更新した

**解決方法**:
1. 警告を確認
2. 必要に応じて最新状態を取得
```bash
esa-cli fetch <記事番号>
```

3. 競合を解決してから更新

### 一括移動での問題

**問題**: `esa-cli move` でエラーが発生する

**原因**:
- 移動先カテゴリが指定されていない
- 移動対象の記事が見つからない
- 権限がない

**解決方法**:
1. 必須オプションを確認
```bash
# 移動先カテゴリは必須
esa-cli move -o 移動先カテゴリ
esa-cli move --to 移動先カテゴリ
```

2. 移動対象の記事が存在するか確認
```bash
esa-cli list -c 元カテゴリ -u 自分のユーザー名
```

3. 権限を確認

### ファイル名の問題

**問題**: 更新時にファイル名エラーが発生する

**原因**: ファイル名が正しい形式でない

**解決方法**: ファイル名を正しい形式にする
```
正しい形式: <記事番号>-<タイトル>.md
例: 123-article-title.md
```

### ネットワークエラー

**問題**: ネットワーク接続エラーが発生する

**原因**:
- インターネット接続の問題
- esa.ioのサービス障害
- プロキシ設定の問題

**解決方法**:
1. インターネット接続を確認
2. esa.ioのステータスを確認
3. プロキシ設定を確認

### パフォーマンスの問題

**問題**: コマンドの実行が遅い

**原因**:
- 大量の記事を処理している
- ネットワークが遅い
- システムリソースが不足

**解決方法**:
1. 処理件数を制限
```bash
esa-cli list 10  # 10件に制限
```

2. フィルタリングを活用
```bash
esa-cli list -c 特定カテゴリ  # カテゴリで絞り込み
```

3. システムリソースを確認

## デバッグ情報の取得

問題の詳細を確認するには、以下の情報を収集してください：

1. **バージョン情報**
```bash
esa-cli version
```

2. **設定情報**
```bash
cat ~/.esa-cli-config.json
```

3. **システム情報**
```bash
uname -a
go version
```

4. **ネットワーク接続**
```bash
curl -I https://{your-team}.esa.io
```

## サポート

問題が解決しない場合は、以下の情報とともにGitHub Issuesで報告してください：

- エラーメッセージの全文
- 実行したコマンド
- バージョン情報
- システム情報
- 設定ファイル（機密情報は除く） 